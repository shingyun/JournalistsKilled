var ImageInterface = require('../src/Image');
var Box = require('../src/Box');

module.exports = class Image extends ImageInterface {
	constructor(bitmap) {
		super();
		this._bitmap = bitmap;
	}

	getSize() {
		return Promise.resolve(new Box(this._bitmap.width, this._bitmap.height));
	}

	crop(zone) {
		this._bitmap = this._bitmap.crop({
			top: zone.getStartPoint().getX(),
			left: zone.getStartPoint().getY(),
			width: zone.getSize().getWidth(),
			height: zone.getSize().getHeight()
		});

		return Promise.resolve(this);
	}

	saveJPEG(file, quality) {
		var opts = {};

		if (quality !== undefined) {
			opts.quality = quality;
		}

		return this._bitmap.writeFile(file, opts).then(() => this);
	}
}